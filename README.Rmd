---
output: github_document
---

<!-- badges: start -->

[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version-ago/aweek)](https://cran.r-project.org/package=aweek) 
[![Codecov test coverage](https://codecov.io/gh/reconhub/aweek/branch/master/graph/badge.svg)](https://codecov.io/gh/reconhub/aweek?branch=master) 
[![Travis build status](https://travis-ci.org/reconhub/aweek.svg?branch=master)](https://travis-ci.org/reconhub/aweek)
[![Downloads](https://cranlogs.r-pkg.org/badges/grand-total/aweek?color=ff69b4)](https://cran.r-project.org/package=aweek)
[![DOI](https://zenodo.org/badge/172648833.svg)](https://zenodo.org/badge/latestdoi/172648833)

<!-- badges: end -->

# Welcome to the *aweek* package!

This package will convert dates to
[US CDC epiweeks](https://wwwn.cdc.gov/nndss/document/MMWR_Week_overview.pdf),
[isoweeks](http://en.wikipedia.org/wiki/ISO_week_date), and all others in
between with minimal overhead. Other packages such as
[lubridate](https://github.com/tidyverse/lubridate),
[ISOweek](https://cran.r-project.org/package=ISOweek), and
[surveillance](http://surveillance.r-forge.r-project.org/) have the ability to
define ISOweeks and/or epiweeks have the ability to define ISOweeks and/or
epiweeks, the ability to easily switch between day and week intervals is only
available for ISOweeks. However, the ability to easily switch between day and
week intervals is only available for ISOweeks and all of the packages above
have dependencies that require compiled code.

## Installing the package

To install the stable package version from CRAN, you can use

```{r install, eval = FALSE}
install.packages("aweek")
```


To benefit from the latest features and bug fixes, install the development, *github* version of the package using:

```{r install2, eval = FALSE}
remotes::install_github("reconhub/aweek")
```

Note that this requires the package *remotes* installed.


# Main Features

 - `date2week()` converts dates to a week format (YYYY-Www-d) that can start on 
   any day. 
 - `week2date()` / `as.Date()` does the backwards conversion from (YYYY-Www(-d)) to
   a numeric date. 
 - Dependencies only on R itself.

<!-- -->

## Dates to weeks

```{r epiweek}

library(aweek)
set.seed(2019-02-26)
onset <- Sys.Date() + sort(sample(-6:7, 20, replace = TRUE))
onset
date2week(onset, week_start = 1) # ISO weeks starting on Monday (default)
date2week(onset, week_start = 7) # EPI week starting on Sunday
date2week(onset, week_start = 6) # EPI week starting on Saturday
x <- date2week(onset, week_start = "sat", floor_day = TRUE) # truncate to just the weeks
table(x)
table(week2date(x))
```


## Factors

You can also use it to automatically calculate factor levels, which is useful
in tabulating across weeks and including missing values. 

```{r show_factors}
set.seed(2019-02-26)
onset <- Sys.Date() + sort(sample(-48:49, 20, replace = TRUE))
x <- date2week(onset, week_start = "sat", floor_day = TRUE, factor = TRUE)
x
table(x)
```

## Locales

It's also possible to specify the week_start in terms of the current locale, 
however it is important to be aware that code like this may not be portable.

```{r locale_dates, error = TRUE}

# workaround because of differing locale specifications
german <- if (grepl("darwin", R.version$os)) "de_DE.UTF-8" else "de_DE.utf8"
lct <- Sys.getlocale("LC_TIME")
res <- Sys.setlocale("LC_TIME", german)

date2week(Sys.Date(), week_start = "Sonntag")
date2week(Sys.Date(), week_start = "Sunday")

Sys.setlocale("LC_TIME", lct)

```



## Getting help online

Bug reports and feature requests should be posted on *github* using the [*issue*](http://github.com/reconhub/aweek/issues) system. All other questions should be posted on the **RECON forum**: <br>
[http://www.repidemicsconsortium.org/forum/](http://www.repidemicsconsortium.org/forum/)

Contributions are welcome via **pull requests**.

Please note that this project is released with a [Contributor Code of Conduct](CONDUCT.md). By participating in this project you agree to abide by its terms.

